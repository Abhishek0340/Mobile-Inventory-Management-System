import{r as n,a as b,j as t,L as k,b as Q,y}from"./index-C5rQdlcL.js";import{A as I,M as E}from"./AdminLayout-MxYaMzDm.js";const A=()=>{const[u,g]=n.useState([]),[r,d]=n.useState([]),[p,j]=n.useState(""),[o,v]=n.useState(1),[i,x]=n.useState(0),[l,h]=n.useState({name:"",mobile:"",email:""}),[N,f]=n.useState("");n.useEffect(()=>{b.get("https://mobile-inventory-management-system.vercel.app/products").then(e=>g(e.data)).catch(e=>console.error("Error fetching products:",e))},[]),n.useEffect(()=>{f(new Date().toISOString().slice(0,16))},[]);const w=()=>{const e=u.find(s=>s._id===p);if(e&&o>0&&o<=e.quantity){const s={...e,orderQuantity:o,totalPrice:o*e.price};if(r.find(m=>m._id===e._id)){const m=r.map(c=>c._id===e._id?{...c,orderQuantity:c.orderQuantity+o,totalPrice:(c.orderQuantity+o)*c.price}:c);d(m)}else d([...r,s])}else y.error("Invalid quantity or product")};n.useEffect(()=>{const e=r.reduce((s,a)=>s+a.totalPrice,0);x(e)},[r]);const S=e=>{const s=r.filter(a=>a._id!==e);d(s)},$=e=>{const{name:s,value:a}=e.target;h({...l,[s]:a})},P=()=>{const e=`Mobile Inventory Management System 
 Bill Receipt
Customer Name: ${l.name}
Mobile Number: ${l.mobile}
Total Amount: ₹${i}

Products:
${r.map(a=>`${a.name} - ₹${a.price} x ${a.orderQuantity} = ₹${a.totalPrice}`).join(`
`)}

Thank you for your purchase!`,s=encodeURIComponent(e);window.open(`https://wa.me/${l.mobile}?text=${s}`,"_blank")},C=()=>{const e=encodeURIComponent("Mobile Inventory Management System"),s=encodeURIComponent(`Hello ${l.name},

Here is your bill receipt:

`+r.map(a=>`${a.name} - ₹${a.price} x ${a.orderQuantity} = ₹${a.totalPrice}`).join(`
`)+`

Total: ₹${i}

 Thank you for shopping with us!`);window.open(`mailto:${l.email}?subject=${e}&body=${s}`,"_blank")},_=async()=>{const e={customer:l,billDate:N,order:r.map(s=>({productName:s.name,price:s.price,quantity:s.orderQuantity,totalPrice:s.totalPrice})),total:i};try{await b.post("https://mobile-inventory-management-system.vercel.app/save-bill",e),y.success("Bill Saved & Share Successfully..!"),P(),C(),h({name:"",mobile:"",email:""}),d([]),x(0)}catch(s){console.error("Error saving bill:",s)}};return t.jsx(t.Fragment,{children:t.jsxs(I,{children:[t.jsx("div",{className:"text-sm text-gray-600 mb-4",children:t.jsxs("nav",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-gray-500",children:t.jsx(k,{to:"/home",children:t.jsx(E,{fontSize:20})})}),t.jsx("span",{className:"text-gray-400",children:"/"}),t.jsx("span",{className:"font-semibold text-gray-800",children:"Billing"})]})}),t.jsxs("div",{className:"p-4 md:p-6 bg-gray-50 min-h-screen",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 bg-white p-6 rounded-lg shadow mb-6",children:["name","mobile","email"].map((e,s)=>t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-600 mb-1 capitalize",children:[e,":"]}),t.jsx("input",{type:e==="email"?"email":e==="mobile"?"tel":"text",name:e,placeholder:`Enter ${e}`,value:l[e],onChange:$,className:"w-full border border-gray-300 rounded-md p-2 capitalize focus:outline-blue-500",required:!0})]},s))}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 bg-white p-6 rounded-lg shadow mb-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Product:"}),t.jsxs("select",{value:p,onChange:e=>j(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 bg-white focus:outline-blue-500",children:[t.jsx("option",{value:"",children:"Select Product"}),u.map(e=>t.jsxs("option",{value:e._id,children:[e.name," - ₹",e.price.toFixed(2)]},e._id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Quantity:"}),t.jsx("input",{type:"number",value:o,onChange:e=>v(parseInt(e.target.value)),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-blue-500",required:!0})]}),t.jsx("div",{className:"flex items-end",children:t.jsx("button",{onClick:w,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Add to Order"})})]}),t.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("table",{className:"w-full text-sm md:text-base",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2",children:"Product Name"}),t.jsx("th",{className:"px-4 py-2",children:"Price"}),t.jsx("th",{className:"px-4 py-2",children:"Quantity"}),t.jsx("th",{className:"px-4 py-2",children:"Total"}),t.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),t.jsx("tbody",{children:r.map(e=>t.jsxs("tr",{className:"text-center border-b",children:[t.jsx("td",{className:"py-2",children:e.name}),t.jsxs("td",{className:"py-2",children:["₹",e.price.toFixed(2)]}),t.jsx("td",{className:"py-2",children:e.orderQuantity}),t.jsxs("td",{className:"py-2",children:["₹",e.totalPrice.toFixed(2)]}),t.jsx("td",{className:"py-2",children:t.jsx("button",{onClick:()=>S(e._id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded",children:"Remove"})})]},e._id))})]})}),r.length>0&&t.jsx("div",{className:"text-center",children:t.jsx("button",{onClick:_,className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700",children:"Save & Share"})}),t.jsx(Q,{})]})]})})};export{A as default};
